---
import Layout from '../../layouts/Layout.astro';
import Footer from '../../components/Footer.astro';
import ObjectItem from '../../components/ObjectItem.astro';
import hero from '../../assets/hero.jpg';

const rawPosts = Object.values(import.meta.glob('../../data/articles/*.md', { eager: true }));

const allPosts = rawPosts.map((post) => {
    const {file, frontmatter} = post;
    const articleSlug = frontmatter.slug || file.split('/').pop().replace('.md', '');
    return {
        title: frontmatter.title,
        description: frontmatter.description,
        link: `/articles/${articleSlug}`,
        thumbnail: frontmatter.thumbnail || hero.src,
        date: frontmatter.date,
    }
});

const sortedPosts = allPosts.sort((a, b) => new Date(b.date) - new Date(a.date));
---
<Layout 
    title="Arsip Artikel - Desa Wisata Taman Sendang Bandung" 
    description="Jelajahi semua artikel, berita, dan cerita dari Desa Wisata Taman Sendang Bandung."
>
    <main>
        <div
            class="relative w-full bg-cover bg-center pt-48 pb-24"
						style={{ backgroundImage: `url('/content/boro.jpg')` }}
        >
            <div class="absolute inset-0 bg-black/60"></div>
            
            <div class="relative container mx-auto px-4 flex flex-col text-white items-start justify-center gap-[16px] text-left">
                <h1 class="text-4xl md:text-5xl !text-white font-extrabold leading-tight" style="text-shadow: 0 2px 4px rgba(0,0,0,0.5);">Arsip Artikel</h1>
								<p>Temukan semua cerita, kegiatan, dan pengumuman yang pernah kami bagikan.</p>
            </div>
        </div>

        <div class="container mx-auto px-4 py-16">
            <div class="w-full flex flex-wrap -mx-4">
                {sortedPosts.map((item) => (
                    <div class="w-full md:w-1/2 lg:w-1/3 px-4 mb-8">
                        <ObjectItem {...item} />
                    </div>
                ))}
            </div>
        </div>
    </main>
    <Footer />
</Layout>
